{"ast":null,"code":"// üîå Servicio API centralizado\n// Este archivo maneja TODAS las comunicaciones con el backend\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/api/v1';\nclass ApiService {\n  constructor() {\n    this.token = localStorage.getItem('token');\n  }\n\n  // ‚úÖ Obtener headers con autenticaci√≥n\n  getHeaders() {\n    return {\n      'Content-Type': 'application/json',\n      ...(this.token && {\n        Authorization: `Bearer ${this.token}`\n      })\n    };\n  }\n\n  // ‚úÖ M√©todo gen√©rico para requests\n  async request(endpoint, options = {}) {\n    const url = `${API_BASE_URL}${endpoint}`;\n    const config = {\n      ...options,\n      headers: this.getHeaders()\n    };\n    try {\n      const response = await fetch(url, config);\n\n      // Si el token expira (401), limpiar y redirigir al login\n      if (response.status === 401) {\n        this.logout();\n        window.location.href = '/login';\n        throw new Error('Token expirado');\n      }\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || `Error ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Error en API:', error);\n      throw error;\n    }\n  }\n\n  // üîê AUTENTICACI√ìN\n  async login(email, password) {\n    const data = await this.request('/auth/login', {\n      method: 'POST',\n      body: JSON.stringify({\n        email,\n        password\n      })\n    });\n    if (data.token) {\n      this.setToken(data.token);\n    }\n    return data;\n  }\n  async register(userData) {\n    return this.request('/auth/register', {\n      method: 'POST',\n      body: JSON.stringify(userData)\n    });\n  }\n  setToken(token) {\n    this.token = token;\n    localStorage.setItem('token', token);\n  }\n  logout() {\n    this.token = null;\n    localStorage.removeItem('token');\n  }\n\n  // üë• MIEMBROS\n  async getMembers(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/member${queryString ? '?' + queryString : ''}`);\n  }\n  async getMemberById(id) {\n    return this.request(`/member/${id}`);\n  }\n  async createMember(memberData) {\n    return this.request('/member', {\n      method: 'POST',\n      body: JSON.stringify(memberData)\n    });\n  }\n  async updateMember(id, memberData) {\n    return this.request(`/member/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(memberData)\n    });\n  }\n  async deleteMember(id) {\n    return this.request(`/member/${id}`, {\n      method: 'DELETE'\n    });\n  }\n\n  // üìä COHORTES (Enrollment)\n  async getEnrollments(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/enrollment${queryString ? '?' + queryString : ''}`);\n  }\n  async createEnrollment(enrollmentData) {\n    return this.request('/enrollment', {\n      method: 'POST',\n      body: JSON.stringify(enrollmentData)\n    });\n  }\n  async updateEnrollment(id, enrollmentData) {\n    return this.request(`/enrollment/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(enrollmentData)\n    });\n  }\n\n  // üéì INSCRIPCIONES DE ESTUDIANTES\n  async getStudentEnrollments(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/student-enrollment${queryString ? '?' + queryString : ''}`);\n  }\n  async createStudentEnrollment(data) {\n    return this.request('/student-enrollment', {\n      method: 'POST',\n      body: JSON.stringify(data)\n    });\n  }\n  async updateStudentEnrollment(id, data) {\n    return this.request(`/student-enrollment/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(data)\n    });\n  }\n  async deleteStudentEnrollment(id) {\n    return this.request(`/student-enrollment/${id}`, {\n      method: 'DELETE'\n    });\n  }\n\n  // üìñ LECCIONES\n  async getLessons(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/lesson${queryString ? '?' + queryString : ''}`);\n  }\n  async createLesson(lessonData) {\n    return this.request('/lesson', {\n      method: 'POST',\n      body: JSON.stringify(lessonData)\n    });\n  }\n\n  // ‚úÖ ASISTENCIAS\n  async getAttendance(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/attendance${queryString ? '?' + queryString : ''}`);\n  }\n  async createAttendance(attendanceData) {\n    return this.request('/attendance', {\n      method: 'POST',\n      body: JSON.stringify(attendanceData)\n    });\n  }\n  async updateAttendance(id, attendanceData) {\n    return this.request(`/attendance/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(attendanceData)\n    });\n  }\n\n  // üë§ USUARIOS\n  async getUsers() {\n    return this.request('/users');\n  }\n  async updateUser(id, userData) {\n    return this.request(`/users/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(userData)\n    });\n  }\n  async deleteUser(id) {\n    return this.request(`/users/${id}`, {\n      method: 'DELETE'\n    });\n  }\n}\nexport default new ApiService();","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","ApiService","constructor","token","localStorage","getItem","getHeaders","Authorization","request","endpoint","options","url","config","headers","response","fetch","status","logout","window","location","href","Error","ok","error","json","message","console","login","email","password","data","method","body","JSON","stringify","setToken","register","userData","setItem","removeItem","getMembers","params","queryString","URLSearchParams","toString","getMemberById","id","createMember","memberData","updateMember","deleteMember","getEnrollments","createEnrollment","enrollmentData","updateEnrollment","getStudentEnrollments","createStudentEnrollment","updateStudentEnrollment","deleteStudentEnrollment","getLessons","createLesson","lessonData","getAttendance","createAttendance","attendanceData","updateAttendance","getUsers","updateUser","deleteUser"],"sources":["/Users/pineros/Downloads/gestion-pastoral-react/src/apiService.js"],"sourcesContent":["// üîå Servicio API centralizado\n// Este archivo maneja TODAS las comunicaciones con el backend\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/api/v1';\n\nclass ApiService {\n  constructor() {\n    this.token = localStorage.getItem('token');\n  }\n\n  // ‚úÖ Obtener headers con autenticaci√≥n\n  getHeaders() {\n    return {\n      'Content-Type': 'application/json',\n      ...(this.token && { Authorization: `Bearer ${this.token}` }),\n    };\n  }\n\n  // ‚úÖ M√©todo gen√©rico para requests\n  async request(endpoint, options = {}) {\n    const url = `${API_BASE_URL}${endpoint}`;\n    const config = {\n      ...options,\n      headers: this.getHeaders(),\n    };\n\n    try {\n      const response = await fetch(url, config);\n\n      // Si el token expira (401), limpiar y redirigir al login\n      if (response.status === 401) {\n        this.logout();\n        window.location.href = '/login';\n        throw new Error('Token expirado');\n      }\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || `Error ${response.status}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      console.error('Error en API:', error);\n      throw error;\n    }\n  }\n\n  // üîê AUTENTICACI√ìN\n  async login(email, password) {\n    const data = await this.request('/auth/login', {\n      method: 'POST',\n      body: JSON.stringify({ email, password }),\n    });\n\n    if (data.token) {\n      this.setToken(data.token);\n    }\n\n    return data;\n  }\n\n  async register(userData) {\n    return this.request('/auth/register', {\n      method: 'POST',\n      body: JSON.stringify(userData),\n    });\n  }\n\n  setToken(token) {\n    this.token = token;\n    localStorage.setItem('token', token);\n  }\n\n  logout() {\n    this.token = null;\n    localStorage.removeItem('token');\n  }\n\n  // üë• MIEMBROS\n  async getMembers(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/member${queryString ? '?' + queryString : ''}`);\n  }\n\n  async getMemberById(id) {\n    return this.request(`/member/${id}`);\n  }\n\n  async createMember(memberData) {\n    return this.request('/member', {\n      method: 'POST',\n      body: JSON.stringify(memberData),\n    });\n  }\n\n  async updateMember(id, memberData) {\n    return this.request(`/member/${id}`, {\n      method: 'PATCH',\n      body: JSON.stringify(memberData),\n    });\n  }\n\n  async deleteMember(id) {\n    return this.request(`/member/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  // üìä COHORTES (Enrollment)\n  async getEnrollments(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/enrollment${queryString ? '?' + queryString : ''}`);\n  }\n\n  async createEnrollment(enrollmentData) {\n    return this.request('/enrollment', {\n      method: 'POST',\n      body: JSON.stringify(enrollmentData),\n    });\n  }\n\n  async updateEnrollment(id, enrollmentData) {\n    return this.request(`/enrollment/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(enrollmentData),\n    });\n  }\n\n  // üéì INSCRIPCIONES DE ESTUDIANTES\n  async getStudentEnrollments(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/student-enrollment${queryString ? '?' + queryString : ''}`);\n  }\n\n  async createStudentEnrollment(data) {\n    return this.request('/student-enrollment', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async updateStudentEnrollment(id, data) {\n    return this.request(`/student-enrollment/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async deleteStudentEnrollment(id) {\n    return this.request(`/student-enrollment/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  // üìñ LECCIONES\n  async getLessons(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/lesson${queryString ? '?' + queryString : ''}`);\n  }\n\n  async createLesson(lessonData) {\n    return this.request('/lesson', {\n      method: 'POST',\n      body: JSON.stringify(lessonData),\n    });\n  }\n\n  // ‚úÖ ASISTENCIAS\n  async getAttendance(params = {}) {\n    const queryString = new URLSearchParams(params).toString();\n    return this.request(`/attendance${queryString ? '?' + queryString : ''}`);\n  }\n\n  async createAttendance(attendanceData) {\n    return this.request('/attendance', {\n      method: 'POST',\n      body: JSON.stringify(attendanceData),\n    });\n  }\n\n  async updateAttendance(id, attendanceData) {\n    return this.request(`/attendance/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(attendanceData),\n    });\n  }\n\n  // üë§ USUARIOS\n  async getUsers() {\n    return this.request('/users');\n  }\n\n  async updateUser(id, userData) {\n    return this.request(`/users/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(userData),\n    });\n  }\n\n  async deleteUser(id) {\n    return this.request(`/users/${id}`, {\n      method: 'DELETE',\n    });\n  }\n}\n\nexport default new ApiService();\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}